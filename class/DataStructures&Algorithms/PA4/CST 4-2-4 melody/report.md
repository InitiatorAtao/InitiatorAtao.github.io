## 算法思路和实现要点
对所给的字符串执行 KMP 算法,所得到的跳转结构构成一棵树,可以动态扩展,每次的询问即在树中给出数个节点,求它们长度不超过原串一半的公共祖先 (LCA),使用倍增法,维护树上每个节点的深度及 $2^{k}$ 级祖先,每次询问将两个点向上跳到同一高度再上跳直到出现公共祖先即可得到它们的 LCA,多个点的 LCA 顺序合并即可,注意每次求出 LCA 后可能要上跳直到长度不超过当前串长一半.
## 渐进时间复杂度的分析，包含过程
KMP 跳转树的构建和动态扩展是线性的,倍增 $2^{k}$ 级祖先需要 $O(n\log n)$ 时间 (随点数增加增大).求 LCA 需要 $O(q\log q)$ 时间,总体需要 $O((n+q)\log (n+q))$ 时间.
## 渐进空间复杂度的分析，包含过程
倍增祖先的需要 $O((n+q)\log(n+q))$ 空间,其余空间均为线性的,故总体空间复杂度为 $O((n+q)\log(n+q))$.
## 遇到的困难和解决方法
倍增法在树根附近有边界问题,为深度数组在根部赋初值后解决.
## 估计完成本题所用时间 
2h
## 关于本题的更多感想
